<!DOCTYPE html>
<html lang = "ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ì˜ˆì•½ ì ‘ìˆ˜</title>
<link rel="stylesheet" href="/css/AcceptanceReceptionstyle.css">

<style>

</style>
</head>
<body>
<!-- ì‚¬ì´ë“œ ë°” -->
<div class = "sidebar">
	<div class = "profile">
		<div class = "profile-icon">ğŸ‘¤</div>
		<span>ë‚´ í”„ë¡œí•„</span>
	</div>
	
	<div class = "menu-item">
		<div class = "menu-icon">ğŸ””</div>
		<span>ì•Œë¦¼</span>
	</div>
	
	<a href="acceptanceHome" class = "menu-item">
		<div class = "menu-icon">ğŸ </div>
		<span>í™ˆ</span>
	</a>
	
	<div class="menu-item has-submenu" onclick="toggleSubMenu(this)">
		<div class = "menu-icon">ğŸ“‹</div>
		<span>ì§„ë£Œ</span>
	</div>
	<ul class="submenu">
	<a href="acceptanceDoctor">
   	 	<li class="submenu-item active">ì˜ì‚¬ ìŠ¤ì¼€ì¤„</li></a>
   	 <a href ="acceptanceCondition">
    	<li class="submenu-item">ì§„ë£Œ ìƒíƒœ</li></a>

	</ul>
	
	<div class="menu-item has-submenu" onclick="toggleSubMenu(this)">
		<div class = "menu-icon">ğŸ‘¥</div>
		<span>ì˜ˆì•½</span>
	</div>
	
	<div class = "menu-item">
		<div class = "menu-icon">âœï¸</div>
		<span>ìˆ˜ë‚©</span>
	</div>
	
	<div class = "menu-item">
		<div class = "menu-icon">ğŸ’œ</div>
		<span>ì¬ê³ </span>
	</div>
	
	<div class = "menu-item">
		<div class = "menu-icon">ğŸ‘¥</div>
		<span>ì…ì›</span>
	</div>
</div>

<div class="main-content">
  <div class="schedule-wrapper">
    <!-- Day/Week/Month íƒ­ -->
    <div class="tab-header">
      <button class="tab active" onclick="showTab('day')">Day</button>
      <button class="tab" onclick="showTab('week')">Week</button>
    </div>
    
	<div class="top-center-date">
	  <button onclick="changeDate(-1)" class="date-nav">&lt;</button>
	  <span class="date-icon">ğŸ“…</span>
	  <span id="currentDate">2025-05-29</span>
	  <button onclick="changeDate(1)" class="date-nav">&gt;</button>
	</div>
    <div class="top-right-btn">
      <button class="register-btn-fixed">ì˜ˆì•½ ë“±ë¡</button>
    </div>
    
<div id="calendarModal" class="modal" style="display: none;">
  <div class="modal-content" style="width: 300px; padding: 20px;">
    <h3 style="margin-bottom: 10px;">ë‚ ì§œ ì„ íƒ</h3>
    <input type="date" id="calendarDateInput" style="width: 100%; padding: 10px; font-size: 16px;" />
    <div style="margin-top: 20px; text-align: right;">
      <button onclick="closeCalendarModal()" style="padding: 8px 14px; background-color: #ccc;">ì·¨ì†Œ</button>
      <button onclick="applyCalendarDate()" style="padding: 8px 14px; background-color: #2196f3; color: white;">ì ìš©</button>
    </div>
  </div>
</div>

    <!-- Day View -->
    <div id="dayView" class="schedule-view active">
      <div class="schedule-table">
        <!-- ê¸°ì¡´ day ì‹œê°„í‘œ í…Œì´ë¸” ìœ ì§€ -->
        <div class="header-row">
          <div class="time-col-header"></div>
          <div class="header-col">ì§„ë£Œì‹¤1</div>
          <div class="header-col">ì§„ë£Œì‹¤2</div>
          <div class="header-col">ì§„ë£Œì‹¤3</div>
          <div class="header-col">ì§„ë£Œì‹¤4</div>
        </div>

    <!-- ì‹œê°„ëŒ€ë³„ í–‰ë“¤ (30ë¶„ ë‹¨ìœ„) -->
    <div class="schedule-row">
      <div class="time-col">09:00</div>
      <div class="cell"></div>
      <div class="cell"></div>
      <div class="cell green">[ì´ìˆ˜ì§„]<br>ìƒë‹´</div>
      <div class="cell"></div>
    </div>

    <div class="schedule-row">
      <div class="time-col">09:30</div>
      <div class="cell"></div>
      <div class="cell"></div>
      <div class="cell green">[ì´ìˆ˜ì§„]<br>ìƒë‹´</div>
      <div class="cell"></div>
    </div>

    <div class="schedule-row">
      <div class="time-col">10:00</div>
      <div class="cell blue">[í™ê¸¸ë™]<br>ê°„ë‹¨ ìˆ˜ìˆ </div>
      <div class="cell"></div>
      <div class="cell"></div>
      <div class="cell"></div>
    </div>

    <div class="schedule-row">
      <div class="time-col">10:30</div>
      <div class="cell blue">[í™ê¸¸ë™]</div>
      <div class="cell"></div>
      <div class="cell"></div>
      <div class="cell"></div>
    </div>

    <div class="schedule-row">
      <div class="time-col">11:00</div>
      <div class="cell"></div>
      <div class="cell pink">[ë°•ë³´ê²€]<br>ì…ì› ì ‘ìˆ˜</div>
      <div class="cell"></div>
      <div class="cell"></div>
    </div>

    <!-- ë‚˜ë¨¸ì§€ ì‹œê°„ëŒ€ (ë¹ˆ ìƒíƒœë¡œ) -->
    <div class="schedule-row"><div class="time-col">11:30</div><div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div></div>
    <div class="schedule-row"><div class="time-col">12:00</div><div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div></div>
    <div class="schedule-row"><div class="time-col">12:30</div><div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div></div>
    <div class="schedule-row"><div class="time-col">13:00</div><div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div></div>
    <div class="schedule-row"><div class="time-col">13:30</div><div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div></div>
    <div class="schedule-row"><div class="time-col">14:00</div><div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div></div>
    <div class="schedule-row"><div class="time-col">14:30</div><div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div></div>
    <div class="schedule-row"><div class="time-col">15:00</div><div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div></div>
    <div class="schedule-row"><div class="time-col">15:30</div><div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div></div>
    <div class="schedule-row"><div class="time-col">16:00</div><div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div></div>
    <div class="schedule-row"><div class="time-col">16:30</div><div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div></div>
    <div class="schedule-row"><div class="time-col">17:00</div><div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div></div>
  </div>
</div>

 <!-- Week View -->
    <div id="weekView" class="schedule-view">
      <div class="schedule-table">
        <div class="header-row">
          <div class="time-col-header"></div>
          <div class="header-col">ì›”</div>
          <div class="header-col">í™”</div>
          <div class="header-col">ìˆ˜</div>
          <div class="header-col">ëª©</div>
          <div class="header-col">ê¸ˆ</div>
        </div>
        <!-- ì‹œê°„ëŒ€ë³„ í–‰ ë°˜ë³µ -->
        <div class="schedule-row"><div class="time-col">09:00</div><div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div></div>
        <div class="schedule-row"><div class="time-col">09:30</div><div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div></div>
        <div class="schedule-row"><div class="time-col">10:00</div><div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div></div>
        <div class="schedule-row"><div class="time-col">10:30</div><div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div></div>
        <div class="schedule-row"><div class="time-col">11:00</div><div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div></div>
    	<div class="schedule-row"><div class="time-col">11:30</div><div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div></div>
	    <div class="schedule-row"><div class="time-col">12:00</div><div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div></div>
	    <div class="schedule-row"><div class="time-col">12:30</div><div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div></div>
	    <div class="schedule-row"><div class="time-col">13:00</div><div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div></div>
	    <div class="schedule-row"><div class="time-col">13:30</div><div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div></div>
	    <div class="schedule-row"><div class="time-col">14:00</div><div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div></div>
	    <div class="schedule-row"><div class="time-col">14:30</div><div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div></div>
	    <div class="schedule-row"><div class="time-col">15:00</div><div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div></div>
	    <div class="schedule-row"><div class="time-col">15:30</div><div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div></div>
	    <div class="schedule-row"><div class="time-col">16:00</div><div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div></div>
	    <div class="schedule-row"><div class="time-col">16:30</div><div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div></div>
	    <div class="schedule-row"><div class="time-col">17:00</div><div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div></div>  
      </div>
    </div>


<div id="reservationModal" class="modal" style="display:none;">
  <div class="modal-content">
    <h2>ì˜ˆì•½ ë“±ë¡</h2>
    <form id="reservationForm">
      <label>ì´ë¦„</label>
      <input type="text" name="name" required>

      <label>ì£¼ë¯¼ë²ˆí˜¸</label>
      <input type="text" name="rrn" placeholder="ì˜ˆ: 123456-1234567" required>

      <label>ì—°ë½ì²˜</label>
      <input type="tel" name="phone" placeholder="010-0000-0000" required>

      <label>ì˜ˆì•½ ì¼ì‹œ</label>
      <input type="datetime-local" name="date" required>

      <label>ì§„ë£Œì‹¤</label>
      <select name="department" required>
        <option value="">ì„ íƒ</option>
        <option>ì§„ë£Œì‹¤1</option>
        <option>ì§„ë£Œì‹¤2</option>
        <option>ì§„ë£Œì‹¤3</option>
        <option>ì§„ë£Œì‹¤4</option>
      </select>
      
      <label>ì§„ë£Œ ê³¼ëª©</label>
      <select name="object" required>
        <option value="">ì„ íƒ</option>
        <option>í˜¸í¡ê¸°ë‚´ê³¼</option>
        <option>ë‚´ë¶„ë¹„ë‚´ê³¼</option>
        <option>ìˆœí™˜ê¸°ë‚´ê³¼</option>

      </select>
      
      <label>ë³‘ëª…</label>
		<input type="text" name="disease" placeholder="ì˜ˆ: ê°ê¸°, ìœ„ì—¼ ë“±" required> 

      <label>ë‹´ë‹¹ ì˜ì‚¬</label>
      <input type="text" name="doctor" required>

      <div class="modal-buttons">
        <button type="button" class="cancel-btn" onclick="closeModal()">ì·¨ì†Œ</button>
        <button type="submit" class="save-btn">ì €ì¥</button>
      </div>
    </form>
  </div>
</div>

<!-- ì˜ˆì•½ ìƒì„¸ ì¡°íšŒ/ìˆ˜ì •ìš© ëª¨ë‹¬ -->
<div id="reservationDetailModal" class="modal" style="display: none;">
<div class="modal-content" style="position: relative;">
    <h2>ì˜ˆì•½ ì •ë³´</h2>
    <button type="button" class="cancel-reservation-btn" onclick="cancelReservation()" 
      style="position: absolute; height: 30px; top: 32px; right: 30px; background: #f55; color: white; border: none; padding: 5px 10px; cursor: pointer; border-radius: 5px;">
      ì˜ˆì•½ ì·¨ì†Œ
    </button>
    <form id="editReservationForm">
      <label>ì´ë¦„</label>
      <input type="text" name="editName" required>

      <label>ì£¼ë¯¼ë²ˆí˜¸</label>
      <input type="text" name="editRRN" required>

      <label>ì—°ë½ì²˜</label>
      <input type="text" name="editPhone" required>

      <label>ì˜ˆì•½ ì¼ì‹œ</label>
      <input type="datetime-local" name="editDate" required>

      <label>ì§„ë£Œì‹¤</label>
      <select name="editDepartment" required>
        <option value="">ì„ íƒ</option>
        <option>ì§„ë£Œì‹¤1</option>
        <option>ì§„ë£Œì‹¤2</option>
        <option>ì§„ë£Œì‹¤3</option>
        <option>ì§„ë£Œì‹¤4</option>
      </select>

      <label>ë³‘ëª…</label>
      <input type="text" name="editDisease" required>

      <label>ë‹´ë‹¹ ì˜ì‚¬</label>
      <input type="text" name="editDoctor" required>

      <div class="modal-buttons">
        <button type="button" class="cancel-btn" onclick="closeDetailModal()">ë‹«ê¸°</button>
        <button type="submit" class="save-btn">ìˆ˜ì •</button>
      </div>
    </form>
  </div>
</div>


<script>
function toggleSubMenu(menuItem) {
    const allMenuItems = document.querySelectorAll('.menu-item');
    const allSubmenus = document.querySelectorAll('.submenu');

    // í˜„ì¬ ì´ë¯¸ ì—´ë ¤ ìˆëŠ” ê²½ìš° ë‹«ê¸°
    const isActive = menuItem.classList.contains('active');
    allMenuItems.forEach(item => item.classList.remove('active'));
    allSubmenus.forEach(sub => sub.style.display = 'none');

    // ë‹¤ì‹œ ì—´ê¸° (ë‹«ê¸° ìƒíƒœì˜€ë‹¤ë©´)
    if (!isActive) {
        menuItem.classList.add('active');
        const submenu = menuItem.nextElementSibling;
        if (submenu && submenu.classList.contains('submenu')) {
            submenu.style.display = 'block';
        }
    }
}

// í•˜ìœ„ ë©”ë‰´ í´ë¦­ ì‹œ í™œì„±í™” ì²˜ë¦¬
document.addEventListener('DOMContentLoaded', function () {
    const submenuItems = document.querySelectorAll('.submenu-item');
    submenuItems.forEach(item => {
        item.addEventListener('click', function () {
            submenuItems.forEach(i => i.classList.remove('active'));
            item.classList.add('active');
        });
    });
});

 // "ì˜ˆì•½ ë“±ë¡" ë²„íŠ¼ í´ë¦­ ì‹œ ëª¨ë‹¬ ì—´ê¸°
document.querySelector('.register-btn-fixed').addEventListener('click', function () {
  document.getElementById('reservationForm').reset();
  document.getElementById('reservationModal').style.display = 'flex';
});

// ëª¨ë‹¬ ë‹«ê¸° í•¨ìˆ˜
function closeModal() {
  document.getElementById('reservationModal').style.display = 'none';
}

// âœ… ì €ì¥ ë²„íŠ¼ í´ë¦­ ì‹œ ë™ì‘ - í•˜ë‚˜ë¡œ í†µí•©í•œ ë²„ì „
document.getElementById('reservationForm').addEventListener('submit', function (e) {
  e.preventDefault(); // ìƒˆë¡œê³ ì¹¨ ë°©ì§€

  // ì…ë ¥ê°’ ê°€ì ¸ì˜¤ê¸°
  const name = this.name.value;
  const date = new Date(this.date.value);
  const department = this.department.value;
  const disease = this.disease.value;
  const object = this.object.value;

  const hour = String(date.getHours()).padStart(2, '0');
  const minute = String(date.getMinutes()).padStart(2, '0');
  const timeStr = `${hour}:${minute}`;

  // ì§„ë£Œì‹¤ ì¸ë±ìŠ¤ ë§¤í•‘
  const roomIndex = {
    'ì§„ë£Œì‹¤1': 1,
    'ì§„ë£Œì‹¤2': 2,
    'ì§„ë£Œì‹¤3': 3,
    'ì§„ë£Œì‹¤4': 4
  }[department];

  if (roomIndex === undefined) {
    alert('ì§„ë£Œì‹¤ì„ ì •í™•íˆ ì„ íƒí•´ì£¼ì„¸ìš”.');
    return;
  }

  const rows = document.querySelectorAll('.schedule-row');
  let inserted = false;

for (const row of rows) {
  const timeCol = row.querySelector('.time-col');
  if (timeCol && timeCol.textContent.trim() === timeStr) {
    const cells = row.querySelectorAll('.cell');
    const targetCell = cells[roomIndex - 1];

if (targetCell.innerHTML.trim() !== '') {
  alert("í•´ë‹¹ ì‹œê°„ëŒ€ì— ì´ë¯¸ ì˜ˆì•½ì´ ì¡´ì¬í•©ë‹ˆë‹¤.");
  return;  // ì¤‘ë³µ ì‹œ í•¨ìˆ˜ ì¢…ë£Œ
}

    targetCell.classList.add('green');
    targetCell.innerHTML = `[${name}]<br>${disease}`;
    targetCell.innerHTML = `[${name}]<br>${disease}<br>${object}`;
    

    targetCell.dataset.name = name;
    targetCell.dataset.rrn = this.rrn.value;
    targetCell.dataset.phone = this.phone.value;
    targetCell.dataset.date = this.date.value;
    targetCell.dataset.department = department;
    targetCell.dataset.disease = disease;
    targetCell.dataset.doctor = this.doctor.value;
    targetCell.dataset.object = object;

    targetCell.addEventListener('click', function () {
      document.querySelector('input[name="editName"]').value = this.dataset.name || '';
      document.querySelector('input[name="editRRN"]').value = this.dataset.rrn || '';
      document.querySelector('input[name="editPhone"]').value = this.dataset.phone || '';
      document.querySelector('input[name="editDate"]').value = this.dataset.date || '';
      document.querySelector('select[name="editDepartment"]').value = this.dataset.department || '';
      document.querySelector('input[name="editDisease"]').value = this.dataset.disease || '';
      document.querySelector('select[name="editObject"]').value = this.dataset.object || '';
      document.querySelector('input[name="editDoctor"]').value = this.dataset.doctor || '';

      selectedCell = this;
      document.getElementById('reservationDetailModal').style.display = 'flex';
    });

    inserted = true;
    break; // âœ… ì²˜ë¦¬ ì™„ë£Œ í›„ ë£¨í”„ ì¤‘ë‹¨
  }
}


if (!inserted) {
  // ì•„ë¬´ ì…€ì—ë„ ë„£ì§€ ëª»í–ˆì„ ê²½ìš°ë§Œ ë©”ì‹œì§€ í‘œì‹œ
  alert("ì…ë ¥í•œ ì‹œê°„ì— í•´ë‹¹í•˜ëŠ” ì…€ì´ ì—†ìŠµë‹ˆë‹¤.");
} else if (!document.getElementById('reservationModal').style.display.includes('none')) {
  // ì •ìƒ ë“±ë¡ë˜ì—ˆì„ ê²½ìš°ë§Œ ëª¨ë‹¬ ë‹«ê¸°
  alert('ì˜ˆì•½ì´ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.');
  closeModal();
}
});



let selectedCell = null;
// ì˜ˆì•½ ì…€ í´ë¦­ ì‹œ ìƒì„¸ ë³´ê¸° ëª¨ë‹¬ ì—´ê¸°
document.querySelectorAll('.cell.green').forEach(cell => {
  cell.addEventListener('click', function () {
    const [nameLine, diseaseLine] = this.innerHTML.split('<br>');

    document.querySelector('input[name="editName"]').value = nameLine.replace(/\[|\]/g, '');
    document.querySelector('input[name="editDisease"]').value = diseaseLine || '';

    // ìˆ˜ì • ì‹œ ë‹¤ì‹œ ë„£ê¸° ìœ„í•´ í´ë¦­í•œ ì…€ ì €ì¥
    selectedCell = this;

    document.getElementById('reservationDetailModal').style.display = 'flex';
  });
});

//ìˆ˜ì •ì™„ë£Œì‹œ ì…€ ë‚´ìš© ë°˜ì˜
document.getElementById('editReservationForm').addEventListener('submit', function (e) {
  e.preventDefault();

  const newName = this.editName.value;
  const newRRN = this.editRRN.value;
  const newPhone = this.editPhone.value;
  const newDate = this.editDate.value;
  const newDepartment = this.editDepartment.value;
  const newDisease = this.editDisease.value;
  const newDoctor = this.editDoctor.value;
  const newObject = this.editObject.value;

  if (!selectedCell) return;

  // ë‚ ì§œì™€ ì‹œê°„ íŒŒì‹±
  const dateObj = new Date(newDate);
  const hour = String(dateObj.getHours()).padStart(2, '0');
  const minute = String(dateObj.getMinutes()).padStart(2, '0');
  const timeStr = `${hour}:${minute}`;

  const roomIndex = {
    'ì§„ë£Œì‹¤1': 1,
    'ì§„ë£Œì‹¤2': 2,
    'ì§„ë£Œì‹¤3': 3,
    'ì§„ë£Œì‹¤4': 4
  }[newDepartment];

  if (roomIndex === undefined) {
    alert("ì§„ë£Œì‹¤ì„ ì •í™•íˆ ì„ íƒí•´ì£¼ì„¸ìš”.");
    return;
  }

  const rows = document.querySelectorAll('.schedule-row');
  let newCell = null;
  let foundRow = false;

  for (const row of rows) {
    const timeCol = row.querySelector('.time-col');
    if (timeCol && timeCol.textContent.trim() === timeStr) {
      const cells = row.querySelectorAll('.cell');
      newCell = cells[roomIndex - 1];
      foundRow = true;
      break;
    }
  }

  if (!foundRow || !newCell) {
    alert("ì…ë ¥í•œ ì‹œê°„ì— í•´ë‹¹í•˜ëŠ” ì…€ì´ ì—†ìŠµë‹ˆë‹¤.");
    return;
  }

  // ì¤‘ë³µ ì²´í¬: ìƒˆ ì…€ì— ì˜ˆì•½ì´ ìˆê³ , ê·¸ê²Œ ìê¸° ì…€ì´ ì•„ë‹Œ ê²½ìš°
  if (newCell !== selectedCell && newCell.innerHTML.trim() !== '') {
    alert("í•´ë‹¹ ì‹œê°„ëŒ€ì— ì´ë¯¸ ì˜ˆì•½ì´ ì¡´ì¬í•©ë‹ˆë‹¤.");
    return;
  }

  // âœ… ê¸°ì¡´ ì…€ ì´ˆê¸°í™”
  selectedCell.classList.remove('green');
  selectedCell.innerHTML = '';
  selectedCell.removeAttribute('data-name');
  selectedCell.removeAttribute('data-rrn');
  selectedCell.removeAttribute('data-phone');
  selectedCell.removeAttribute('data-date');
  selectedCell.removeAttribute('data-department');
  selectedCell.removeAttribute('data-disease');
  selectedCell.removeAttribute('data-doctor');

  // âœ… ìƒˆ ì…€ì— ì˜ˆì•½ ì •ë³´ ë“±ë¡
  newCell.classList.add('green');
  newCell.innerHTML = `[${newName}]<br>${newDisease}<br>${newObject}`;
  newCell.dataset.name = newName;
  newCell.dataset.rrn = newRRN;
  newCell.dataset.phone = newPhone;
  newCell.dataset.date = newDate;
  newCell.dataset.department = newDepartment;
  newCell.dataset.disease = newDisease;
  newCell.dataset.doctor = newDoctor;
  newCell.dataset.object = newObject;

  // âœ… ì…€ í´ë¦­ ì‹œ ë‹¤ì‹œ ìˆ˜ì •í•  ìˆ˜ ìˆê²Œ ì´ë²¤íŠ¸ ë“±ë¡
  newCell.addEventListener('click', function () {
    document.querySelector('input[name="editName"]').value = this.dataset.name || '';
    document.querySelector('input[name="editRRN"]').value = this.dataset.rrn || '';
    document.querySelector('input[name="editPhone"]').value = this.dataset.phone || '';
    document.querySelector('input[name="editDate"]').value = this.dataset.date || '';
    document.querySelector('select[name="editDepartment"]').value = this.dataset.department || '';
    document.querySelector('input[name="editDisease"]').value = this.dataset.disease || '';
    document.querySelector('input[name="editDoctor"]').value = this.dataset.doctor || '';

    selectedCell = this;
    document.getElementById('reservationDetailModal').style.display = 'flex';
  });

  // âœ… ìˆ˜ì • ì™„ë£Œ ì‹œ ëª¨ë‹¬ ë‹«ê¸°
  closeDetailModal();
});

//ëª¨ë‹¬ ë‹«ê¸°
function closeDetailModal() {
  document.getElementById('reservationDetailModal').style.display = 'none';
}
function cancelReservation() {
  if (!selectedCell) return;

  if (confirm("ì •ë§ë¡œ ì´ ì˜ˆì•½ì„ ì·¨ì†Œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?")) {
    // ì…€ ì´ˆê¸°í™”
    selectedCell.classList.remove('green');
    selectedCell.innerHTML = '';
    selectedCell.removeAttribute('data-name');
    selectedCell.removeAttribute('data-rrn');
    selectedCell.removeAttribute('data-phone');
    selectedCell.removeAttribute('data-date');
    selectedCell.removeAttribute('data-department');
    selectedCell.removeAttribute('data-disease');
    selectedCell.removeAttribute('data-doctor');

    // ëª¨ë‹¬ ë‹«ê¸°
    closeDetailModal();

    // ì„ íƒ í•´ì œ
    selectedCell = null;
  }
}

function showTab(view) {
  const tabs = document.querySelectorAll('.tab');
  const views = document.querySelectorAll('.schedule-view');
  const dateWrapper = document.querySelector('.top-center-date');

  tabs.forEach(tab => tab.classList.remove('active'));
  views.forEach(v => v.classList.remove('active'));

  if (view === 'day') {
    tabs[0].classList.add('active');
    document.getElementById('dayView').classList.add('active');
    dateWrapper.style.display = 'flex';
  } else if (view === 'week') {
    tabs[1].classList.add('active');
    document.getElementById('weekView').classList.add('active');
    dateWrapper.style.display = 'none';
  }
}
document.addEventListener('DOMContentLoaded', function () {
  const today = new Date();
  const formatted = today.toISOString().split('T')[0]; // YYYY-MM-DD
  document.getElementById('currentDate').textContent = `ğŸ“… ${formatted}`;
});

//ë‚ ì§œ ì´ë™í•¨ìˆ˜
let currentDateObj = new Date(); // ì „ì—­ ë³€ìˆ˜ë¡œ í˜„ì¬ ë‚ ì§œ ì €ì¥

function updateDateDisplay() {
  const formatted = currentDateObj.toISOString().split('T')[0];
  document.getElementById('currentDate').textContent = formatted;  // ì´ëª¨ì§€ ì œê±°
}

function changeDate(days) {
  currentDateObj.setDate(currentDateObj.getDate() + days);
  updateDateDisplay();
}

// ì´ˆê¸° ë‚ ì§œ í‘œì‹œ
document.addEventListener('DOMContentLoaded', function () {
  updateDateDisplay();
});

document.querySelector('.date-icon').addEventListener('click', function () {
  document.getElementById('calendarDateInput').value = currentDateObj.toISOString().split('T')[0];
  document.getElementById('calendarModal').style.display = 'flex';
});

// ëª¨ë‹¬ ë‹«ê¸°
function closeCalendarModal() {
  document.getElementById('calendarModal').style.display = 'none';
}

// ë‚ ì§œ ì„ íƒ í›„ ì ìš©
function applyCalendarDate() {
  const selectedDate = document.getElementById('calendarDateInput').value;
  if (selectedDate) {
    currentDateObj = new Date(selectedDate);
    updateDateDisplay();
  }
  closeCalendarModal();
}
</script>


</body>
</html>
