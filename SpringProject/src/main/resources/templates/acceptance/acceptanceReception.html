<!DOCTYPE html>
<html lang = "ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>예약 접수</title>
<link rel="stylesheet" href="/css/AcceptanceReceptionstyle.css">

<style>

</style>
</head>
<body>
<!-- 사이드 바 -->
<div class = "sidebar">
	<div class = "profile">
		<div class = "profile-icon">👤</div>
		<span>내 프로필</span>
	</div>
	
	<div class = "menu-item">
		<div class = "menu-icon">🔔</div>
		<span>알림</span>
	</div>
	
	<a href="acceptanceHome" class = "menu-item">
		<div class = "menu-icon">🏠</div>
		<span>홈</span>
	</a>
	
	<div class="menu-item has-submenu" onclick="toggleSubMenu(this)">
		<div class = "menu-icon">📋</div>
		<span>진료</span>
	</div>
	<ul class="submenu">
	<a href="acceptanceDoctor">
   	 	<li class="submenu-item active">의사 스케줄</li></a>
   	 <a href ="acceptanceCondition">
    	<li class="submenu-item">진료 상태</li></a>

	</ul>
	
	<div class="menu-item has-submenu" onclick="toggleSubMenu(this)">
		<div class = "menu-icon">👥</div>
		<span>예약</span>
	</div>
	
	<div class = "menu-item">
		<div class = "menu-icon">✏️</div>
		<span>수납</span>
	</div>
	
	<div class = "menu-item">
		<div class = "menu-icon">💜</div>
		<span>재고</span>
	</div>
	
	<div class = "menu-item">
		<div class = "menu-icon">👥</div>
		<span>입원</span>
	</div>
</div>

<div class="main-content">
    <div class="schedule-wrapper">
      <!-- Day/Week/Month 탭 -->
      <div class="tab-header">
        <button class="tab active">Day</button>
        <button class="tab">Week</button>
        <button class="tab">Month</button>
      </div>
      
<div class="top-right-btn">
  <button class="register-btn-fixed">예약 등록</button>
</div>

      <!-- 시간표 테이블 -->
      <div class="schedule-table">
        <div class="header-row">
          <div class="time-col-header"></div>
          <div class="header-col">진료실1</div>
          <div class="header-col">진료실2</div>
          <div class="header-col">진료실3</div>
          <div class="header-col">진료실4</div>
        </div>

    <!-- 시간대별 행들 (30분 단위) -->
    <div class="schedule-row">
      <div class="time-col">09:00</div>
      <div class="cell"></div>
      <div class="cell"></div>
      <div class="cell green">[이수진]<br>상담</div>
      <div class="cell"></div>
    </div>

    <div class="schedule-row">
      <div class="time-col">09:30</div>
      <div class="cell"></div>
      <div class="cell"></div>
      <div class="cell green">[이수진]<br>상담</div>
      <div class="cell"></div>
    </div>

    <div class="schedule-row">
      <div class="time-col">10:00</div>
      <div class="cell blue">[홍길동]<br>간단 수술</div>
      <div class="cell"></div>
      <div class="cell"></div>
      <div class="cell"></div>
    </div>

    <div class="schedule-row">
      <div class="time-col">10:30</div>
      <div class="cell blue">[홍길동]</div>
      <div class="cell"></div>
      <div class="cell"></div>
      <div class="cell"></div>
    </div>

    <div class="schedule-row">
      <div class="time-col">11:00</div>
      <div class="cell"></div>
      <div class="cell pink">[박보검]<br>입원 접수</div>
      <div class="cell"></div>
      <div class="cell"></div>
    </div>

    <!-- 나머지 시간대 (빈 상태로) -->
    <div class="schedule-row"><div class="time-col">11:30</div><div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div></div>
    <div class="schedule-row"><div class="time-col">12:00</div><div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div></div>
    <div class="schedule-row"><div class="time-col">12:30</div><div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div></div>
    <div class="schedule-row"><div class="time-col">13:00</div><div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div></div>
    <div class="schedule-row"><div class="time-col">13:30</div><div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div></div>
    <div class="schedule-row"><div class="time-col">14:00</div><div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div></div>
    <div class="schedule-row"><div class="time-col">14:30</div><div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div></div>
    <div class="schedule-row"><div class="time-col">15:00</div><div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div></div>
    <div class="schedule-row"><div class="time-col">15:30</div><div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div></div>
    <div class="schedule-row"><div class="time-col">16:00</div><div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div></div>
    <div class="schedule-row"><div class="time-col">16:30</div><div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div></div>
    <div class="schedule-row"><div class="time-col">17:00</div><div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div></div>
  </div>
</div>

<div id="reservationModal" class="modal" style="display:none;">
  <div class="modal-content">
    <h2>예약 등록</h2>
    <form id="reservationForm">
      <label>이름</label>
      <input type="text" name="name" required>

      <label>주민번호</label>
      <input type="text" name="rrn" placeholder="예: 123456-1234567" required>

      <label>연락처</label>
      <input type="tel" name="phone" placeholder="010-0000-0000" required>

      <label>예약 일시</label>
      <input type="datetime-local" name="date" required>

      <label>진료실</label>
      <select name="department" required>
        <option value="">선택</option>
        <option>진료실1</option>
        <option>진료실2</option>
        <option>진료실3</option>
        <option>진료실4</option>
      </select>

      <label>담당 의사</label>
      <input type="text" name="doctor" required>

      <div class="modal-buttons">
        <button type="button" class="cancel-btn" onclick="closeModal()">취소</button>
        <button type="submit" class="save-btn">저장</button>
      </div>
    </form>
  </div>
</div>


<script>
function toggleSubMenu(menuItem) {
    const allMenuItems = document.querySelectorAll('.menu-item');
    const allSubmenus = document.querySelectorAll('.submenu');

    // 현재 이미 열려 있는 경우 닫기
    const isActive = menuItem.classList.contains('active');
    allMenuItems.forEach(item => item.classList.remove('active'));
    allSubmenus.forEach(sub => sub.style.display = 'none');

    // 다시 열기 (닫기 상태였다면)
    if (!isActive) {
        menuItem.classList.add('active');
        const submenu = menuItem.nextElementSibling;
        if (submenu && submenu.classList.contains('submenu')) {
            submenu.style.display = 'block';
        }
    }
}

// 하위 메뉴 클릭 시 활성화 처리
document.addEventListener('DOMContentLoaded', function () {
    const submenuItems = document.querySelectorAll('.submenu-item');
    submenuItems.forEach(item => {
        item.addEventListener('click', function () {
            submenuItems.forEach(i => i.classList.remove('active'));
            item.classList.add('active');
        });
    });
});

  // "예약 등록" 버튼 클릭 시 모달 열기
  document.querySelector('.register-btn-fixed').addEventListener('click', function () {
    document.getElementById('reservationModal').style.display = 'flex';
  });

  // 모달 닫기 함수
  function closeModal() {
    document.getElementById('reservationModal').style.display = 'none';
  }

  // 저장 버튼 클릭 시 동작
  document.getElementById('reservationForm').addEventListener('submit', function (e) {
    e.preventDefault(); // 페이지 리로드 방지
    alert('예약이 저장되었습니다.');
    closeModal();
  });
  
  document.getElementById('reservationForm').addEventListener('submit', function (e) {
  e.preventDefault(); // 새로고침 방지

  // 입력값 가져오기
  const name = this.name.value;
  const date = new Date(this.date.value);
  const department = this.department.value;

  const hour = String(date.getHours()).padStart(2, '0');
  const minute = String(date.getMinutes()).padStart(2, '0');
  const timeStr = `${hour}:${minute}`;

  // 진료실 인덱스 매핑
  const roomIndex = {
    '진료실1': 1,
    '진료실2': 2,
    '진료실3': 3,
    '진료실4': 4
  }[department];

  if (roomIndex === undefined) {
    alert('진료실을 정확히 선택해주세요.');
    return;
  }

  // 시간에 맞는 셀 찾기
  const rows = document.querySelectorAll('.schedule-row');
  let inserted = false;

  rows.forEach(row => {
    const timeCol = row.querySelector('.time-col');
    if (timeCol && timeCol.textContent.trim() === timeStr) {
      const cells = row.querySelectorAll('.cell');
      const targetCell = cells[roomIndex - 1]; // 0부터 시작

      targetCell.classList.add('green');
      targetCell.innerHTML = `[${name}]<br>${department}`;
      inserted = true;
    }
  });

  if (!inserted) {
    alert("입력한 시간에 해당하는 셀이 없습니다.");
  }

  closeModal(); // 모달 닫기
});
</script>


</body>
</html>
