<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ì˜ˆì•½ ì ‘ìˆ˜</title>
<link rel="stylesheet" href="/css/AcceptanceReceptionstyle.css">

<style>

</style>
</head>
<body>
<!-- ì‚¬ì´ë“œ ë°” -->
<div class = "sidebar">
	<div class = "profile">
		<div class = "profile-icon">ğŸ‘¤</div>
		<span>ë‚´ í”„ë¡œí•„</span>
	</div>
	
	<div class = "menu-item">
		<div class = "menu-icon">ğŸ””</div>
		<span>ì•Œë¦¼</span>
	</div>
	
	<a href="acceptanceHome" class = "menu-item">
		<div class = "menu-icon">ğŸ </div>
		<span>í™ˆ</span>
	</a>
	
	<div class="menu-item has-submenu" onclick="toggleSubMenu(this)">
		<div class = "menu-icon">ğŸ“‹</div>
		<span>ì§„ë£Œ</span>
	</div>
	<ul class="submenu">
	<a href="acceptanceDoctor">
   	 	<li class="submenu-item active">ì˜ì‚¬ ìŠ¤ì¼€ì¤„</li></a>
   	 <a href ="acceptanceCondition">
    	<li class="submenu-item">ì§„ë£Œ ìƒíƒœ</li></a>

	</ul>
	
	<div class="menu-item has-submenu" onclick="toggleSubMenu(this)">
		<div class = "menu-icon">ğŸ‘¥</div>
		<span>ì˜ˆì•½</span>
	</div>
	
	<div class = "menu-item">
		<div class = "menu-icon">âœï¸</div>
		<span>ìˆ˜ë‚©</span>
	</div>
	
	<div class = "menu-item">
		<div class = "menu-icon">ğŸ’œ</div>
		<span>ì¬ê³ </span>
	</div>
	
	<div class = "menu-item">
		<div class = "menu-icon">ğŸ‘¥</div>
		<span>ì…ì›</span>
	</div>
</div>

<div class="main-content">
  <div class="schedule-wrapper">
    <!-- Day/Week/Month íƒ­ -->
    <div class="tab-header">
      <button class="tab active" onclick="showTab('day')">Day</button>
      <button class="tab" onclick="showTab('week')">Week</button>
    </div>
    
	<div class="top-center-date">
	  <button onclick="changeDate(-1)" class="date-nav">&lt;</button>
	  <span class="date-icon">ğŸ“…</span>
	  <span id="currentDate">2025-05-29</span>
	  <button onclick="changeDate(1)" class="date-nav">&gt;</button>
	</div>
    <div class="top-right-btn">
      <button class="register-btn-fixed">ì˜ˆì•½ ë“±ë¡</button>
    </div>
    
	<div class="top-center-week" style="display: none; justify-content: center; align-items: center; gap: 8px; margin: 10px 0; font-size: 30px;">
	  <button onclick="changeDate(-7)" class="date-nav">&lt;</button>
	  <span class="date-icon">ğŸ“…</span>
	  <span id="weekDateRange">2025-06-02 ~ 2025-06-08</span>
	  <button onclick="changeDate(7)" class="date-nav">&gt;</button>
	</div>

    
<div id="calendarModal" class="modal" style="display: none;">
  <div class="modal-content" style="width: 300px; padding: 20px;">
    <h3 style="margin-bottom: 10px;">ë‚ ì§œ ì„ íƒ</h3>
    <input type="date" id="calendarDateInput" style="width: 100%; padding: 10px; font-size: 16px;" />
    <div style="margin-top: 20px; text-align: right;">
      <button onclick="closeCalendarModal()" style="padding: 8px 14px; background-color: #ccc;">ì·¨ì†Œ</button>
      <button onclick="applyCalendarDate()" style="padding: 8px 14px; background-color: #2196f3; color: white;">ì ìš©</button>
    </div>
  </div>
</div>

    <!-- Day View -->
    <div id="dayView" class="schedule-view active">
      <div class="schedule-table">
        <!-- ê¸°ì¡´ day ì‹œê°„í‘œ í…Œì´ë¸” ìœ ì§€ -->
        <div class="header-row">
          <div class="time-col-header"></div>
          <div class="header-col">ì§„ë£Œì‹¤1</div>
          <div class="header-col">ì§„ë£Œì‹¤2</div>
          <div class="header-col">ì§„ë£Œì‹¤3</div>
          <div class="header-col">ì§„ë£Œì‹¤4</div>
        </div>


    <!-- ë‚˜ë¨¸ì§€ ì‹œê°„ëŒ€ (ë¹ˆ ìƒíƒœë¡œ) -->
    <div class="schedule-row"><div class="time-col">09:00</div><div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div></div>
    <div class="schedule-row"><div class="time-col">09:30</div><div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div></div>
    <div class="schedule-row"><div class="time-col">10:00</div><div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div></div>
    <div class="schedule-row"><div class="time-col">10:30</div><div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div></div>
    <div class="schedule-row"><div class="time-col">11:00</div><div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div></div>
    <div class="schedule-row"><div class="time-col">11:30</div><div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div></div>
    <div class="schedule-row"><div class="time-col">11:30</div><div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div></div>
    <div class="schedule-row"><div class="time-col">12:00</div><div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div></div>
    <div class="schedule-row"><div class="time-col">12:30</div><div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div></div>
    <div class="schedule-row"><div class="time-col">13:00</div><div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div></div>
    <div class="schedule-row"><div class="time-col">13:30</div><div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div></div>
    <div class="schedule-row"><div class="time-col">14:00</div><div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div></div>
    <div class="schedule-row"><div class="time-col">14:30</div><div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div></div>
    <div class="schedule-row"><div class="time-col">15:00</div><div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div></div>
    <div class="schedule-row"><div class="time-col">15:30</div><div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div></div>
    <div class="schedule-row"><div class="time-col">16:00</div><div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div></div>
    <div class="schedule-row"><div class="time-col">16:30</div><div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div></div>
    <div class="schedule-row"><div class="time-col">17:00</div><div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div></div>
  </div>
</div>

<!-- Month Picker Modal (Weekìš©) -->
<div id="monthPickerModal" class="modal" style="display: none;">
  <div class="modal-content" style="width: 300px; padding: 20px;">
    <h3>ì›” ì„ íƒ</h3>
    <label for="yearSelect">ë…„ë„</label>
    <input type="number" id="yearSelect" min="2000" max="2100" style="width: 100%; padding: 8px; margin-bottom: 10px;" />

    <label for="monthSelect">ì›”</label>
    <select id="monthSelect" style="width: 100%; padding: 8px;">
      <!-- optionì€ ì•„ë˜ scriptì—ì„œ ìë™ ìƒì„± -->
    </select>

    <div style="margin-top: 20px; text-align: right;">
      <button onclick="closeMonthPickerModal()" style="padding: 6px 12px;">ì·¨ì†Œ</button>
      <button onclick="applyMonthSelection()" style="padding: 6px 12px; background-color: #2196f3; color: white;">ì ìš©</button>
    </div>
  </div>
</div>


 <!-- Week View -->
    <div id="weekView" class="schedule-view">
      <div class="schedule-table">
        <div class="header-row">
          <div class="time-col-header"></div>
          <div class="header-col">ì›”</div>
          <div class="header-col">í™”</div>
          <div class="header-col">ìˆ˜</div>
          <div class="header-col">ëª©</div>
          <div class="header-col">ê¸ˆ</div>
        </div>
        <!-- ì‹œê°„ëŒ€ë³„ í–‰ ë°˜ë³µ -->
        <div class="schedule-row"><div class="time-col">09:00</div><div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div></div>
        <div class="schedule-row"><div class="time-col">09:30</div><div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div></div>
        <div class="schedule-row"><div class="time-col">10:00</div><div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div></div>
        <div class="schedule-row"><div class="time-col">10:30</div><div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div></div>
        <div class="schedule-row"><div class="time-col">11:00</div><div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div></div>
    	<div class="schedule-row"><div class="time-col">11:30</div><div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div></div>
	    <div class="schedule-row"><div class="time-col">12:00</div><div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div></div>
	    <div class="schedule-row"><div class="time-col">12:30</div><div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div></div>
	    <div class="schedule-row"><div class="time-col">13:00</div><div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div></div>
	    <div class="schedule-row"><div class="time-col">13:30</div><div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div></div>
	    <div class="schedule-row"><div class="time-col">14:00</div><div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div></div>
	    <div class="schedule-row"><div class="time-col">14:30</div><div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div></div>
	    <div class="schedule-row"><div class="time-col">15:00</div><div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div></div>
	    <div class="schedule-row"><div class="time-col">15:30</div><div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div></div>
	    <div class="schedule-row"><div class="time-col">16:00</div><div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div></div>
	    <div class="schedule-row"><div class="time-col">16:30</div><div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div></div>
	    <div class="schedule-row"><div class="time-col">17:00</div><div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div></div>  
      </div>
    </div>


<div id="reservationModal" class="modal" style="display:none;">
  <div class="modal-content">
    <h2>ì˜ˆì•½ ë“±ë¡</h2>
 	<form id="reservationForm" method="post" action="/acceptance/appointment">
     <label>ì´ë¦„</label>
		<input list="patientList" id="patientNameInput" name="name" required />
		<datalist id="patientList"></datalist>
      
      <label>ì„±ë³„</label>
		<select name="gender" required>
		  <option value="">ì„ íƒ</option>
		  <option value="ë‚¨">ë‚¨</option>
		  <option value="ì—¬">ì—¬</option>
		</select>

		<label>ì£¼ë¯¼ë“±ë¡ë²ˆí˜¸</label>
		<input type="text" name="rrn" placeholder="000000-0000000" required>

      <label>ì—°ë½ì²˜</label>
      <input type="tel" name="phone" placeholder="010-0000-0000" required>

      <label>ì˜ˆì•½ ì¼ì‹œ</label>
      <input type="datetime-local" name="date" required>

      <label>ì§„ë£Œì‹¤</label>
      <select name="room" required>
        <option value="">ì„ íƒ</option>
        <option>ì§„ë£Œì‹¤1</option>
        <option>ì§„ë£Œì‹¤2</option>
        <option>ì§„ë£Œì‹¤3</option>
        <option>ì§„ë£Œì‹¤4</option>
      </select>
      
      <label>ë³‘ëª…</label>
		<input type="text" name="disease" placeholder="ì˜ˆ: ê°ê¸°, ìœ„ì—¼ ë“±" required> 
	
	<label for="doctorSelect">ë‹´ë‹¹ ì˜ì‚¬</label>
	<select id="doctorSelect" name="doctor" required>
	  <option value="">ì˜ì‚¬ ì„ íƒ</option>
	</select>

      <div class="modal-buttons">
        <button type="button" class="cancel-btn" onclick="closeModal()">ì·¨ì†Œ</button>
        <button type="submit" class="save-btn">ì €ì¥</button>
      </div>
    </form>
  </div>
</div>

<!-- ì˜ˆì•½ ìƒì„¸ ì¡°íšŒ/ìˆ˜ì •ìš© ëª¨ë‹¬ -->
<div id="reservationDetailModal" class="modal" style="display: none;">
<div class="modal-content" style="position: relative;">
    <h2>ì˜ˆì•½ ì •ë³´</h2>
    <button type="button" class="cancel-reservation-btn" onclick="cancelReservation()" 
      style="position: absolute; height: 30px; top: 32px; right: 30px; background: #f55; color: white; border: none; padding: 5px 10px; cursor: pointer; border-radius: 5px;">
      ì˜ˆì•½ ì·¨ì†Œ
    </button>
    <form id="editReservationForm">
      <label>ì´ë¦„</label>
      <input type="text" name="editName" required>

      <label>ì£¼ë¯¼ë²ˆí˜¸</label>
      <input type="text" name="editRRN" required>

      <label>ì—°ë½ì²˜</label>
      <input type="text" name="editPhone" required>

      <label>ì˜ˆì•½ ì¼ì‹œ</label>
      <input type="datetime-local" name="editDate" required>

      <label>ì§„ë£Œì‹¤</label>
      <select name="editDepartment" required>
        <option value="">ì„ íƒ</option>
        <option>ì§„ë£Œì‹¤1</option>
        <option>ì§„ë£Œì‹¤2</option>
        <option>ì§„ë£Œì‹¤3</option>
        <option>ì§„ë£Œì‹¤4</option>
      </select>

      <label>ë³‘ëª…</label>
      <input type="text" name="editDisease" required>

      <label>ë‹´ë‹¹ ì˜ì‚¬</label>
      <input type="text" name="editDoctor" required>

      <div class="modal-buttons">
        <button type="button" class="cancel-btn" onclick="closeDetailModal()">ë‹«ê¸°</button>
        <button type="submit" class="save-btn">ìˆ˜ì •</button>
      </div>
    </form>
  </div>
</div>


<script>
function toggleSubMenu(menuItem) {
    const allMenuItems = document.querySelectorAll('.menu-item');
    const allSubmenus = document.querySelectorAll('.submenu');

    // í˜„ì¬ ì´ë¯¸ ì—´ë ¤ ìˆëŠ” ê²½ìš° ë‹«ê¸°
    const isActive = menuItem.classList.contains('active');
    allMenuItems.forEach(item => item.classList.remove('active'));
    allSubmenus.forEach(sub => sub.style.display = 'none');

    // ë‹¤ì‹œ ì—´ê¸° (ë‹«ê¸° ìƒíƒœì˜€ë‹¤ë©´)
    if (!isActive) {
        menuItem.classList.add('active');
        const submenu = menuItem.nextElementSibling;
        if (submenu && submenu.classList.contains('submenu')) {
            submenu.style.display = 'block';
        }
    }
}

// í•˜ìœ„ ë©”ë‰´ í´ë¦­ ì‹œ í™œì„±í™” ì²˜ë¦¬
document.addEventListener('DOMContentLoaded', function () {
    const submenuItems = document.querySelectorAll('.submenu-item');
    submenuItems.forEach(item => {
        item.addEventListener('click', function () {
            submenuItems.forEach(i => i.classList.remove('active'));
            item.classList.add('active');
        });
    });
});

 // "ì˜ˆì•½ ë“±ë¡" ë²„íŠ¼ í´ë¦­ ì‹œ ëª¨ë‹¬ ì—´ê¸°
document.querySelector('.register-btn-fixed').addEventListener('click', function () {
  document.getElementById('reservationForm').reset();
  document.getElementById('reservationModal').style.display = 'flex';
});

// ëª¨ë‹¬ ë‹«ê¸° í•¨ìˆ˜
function closeModal() {
  document.getElementById('reservationModal').style.display = 'none';
}

// âœ… ì €ì¥ ë²„íŠ¼ í´ë¦­ ì‹œ ë™ì‘ - í•˜ë‚˜ë¡œ í†µí•©í•œ ë²„ì „
document.getElementById('reservationForm').addEventListener('submit', function (e) {
  e.preventDefault(); // ìƒˆë¡œê³ ì¹¨ ë°©ì§€

  const name = this.name.value;
  const date = new Date(this.date.value);
  const department = this.room.value;
  const disease = this.disease.value;

  const hour = String(date.getHours()).padStart(2, '0');
  const minute = String(date.getMinutes()).padStart(2, '0');
  const timeStr = `${hour}:${minute}`;

  const roomIndex = {
    'ì§„ë£Œì‹¤1': 1,
    'ì§„ë£Œì‹¤2': 2,
    'ì§„ë£Œì‹¤3': 3,
    'ì§„ë£Œì‹¤4': 4
  }[department];

  if (roomIndex === undefined) {
    alert('ì§„ë£Œì‹¤ì„ ì •í™•íˆ ì„ íƒí•´ì£¼ì„¸ìš”.');
    return;
  }

  const rows = document.querySelectorAll('.schedule-row');
  let targetCell = null;

  for (const row of rows) {
    const timeCol = row.querySelector('.time-col');
    if (timeCol && timeCol.textContent.trim() === timeStr) {
      const cells = row.querySelectorAll('.cell');
      const cell = cells[roomIndex - 1];

      if (cell.innerHTML.trim() !== '') {
        alert("í•´ë‹¹ ì‹œê°„ëŒ€ì— ì´ë¯¸ ì˜ˆì•½ì´ ì¡´ì¬í•©ë‹ˆë‹¤.");
        return;
      }

      targetCell = cell;
      break;
    }
  }

  if (!targetCell) {
    alert("ì…ë ¥í•œ ì‹œê°„ì— í•´ë‹¹í•˜ëŠ” ì…€ì´ ì—†ìŠµë‹ˆë‹¤.");
    return;
  }

  // âœ… JSON ë°©ì‹ìœ¼ë¡œ fetch ì „ì†¡
  const payload = {
    name: this.name.value,
    rrn: this.rrn.value,
    phone: this.phone.value,
    gender: this.gender.value,
    date: this.date.value,
    room: this.room.value,
    disease: this.disease.value,
    doctor: this.doctor.value
  };

  fetch("/acceptance/appointment", {
    method: "POST",
    headers: {
      "Content-Type": "application/json"
    },
    body: JSON.stringify(payload)
  })
  .then(response => {
    return response.text().then(msg => {
      if (!response.ok) throw new Error(msg);
      return msg;
    });
  })
  .then(result => {
    // âœ… ì—¬ê¸°ì„œ ì„±ê³µí•œ ê²½ìš°ì—ë§Œ ì…€ì— í‘œì‹œ
    targetCell.classList.add('green');
    targetCell.innerHTML = `[${payload.name}]<br>${payload.rrn}`;
    targetCell.dataset.name = payload.name;
    targetCell.dataset.rrn = payload.rrn;
    targetCell.dataset.phone = payload.phone;
    targetCell.dataset.date = payload.date;
    targetCell.dataset.department = payload.room;
    targetCell.dataset.disease = payload.disease;
    targetCell.dataset.doctor = payload.doctor;

    alert(result);
    closeModal(); // ëª¨ë‹¬ ë‹«ê¸°
  })
  .catch(err => {
    alert("ì˜ˆì•½ ì‹¤íŒ¨: " + err.message); // ì˜ˆ: "ì¡´ì¬í•˜ì§€ ì•ŠëŠ” í™˜ìì…ë‹ˆë‹¤."
  });
});




let selectedCell = null;
// âœ… ì´ë²¤íŠ¸ ìœ„ì„ (ê°€ì¥ ê¶Œì¥ ë°©ì‹)
document.querySelector('.schedule-table').addEventListener('click', function (e) {
  const cell = e.target;
  if (cell.classList.contains('green')) {
    openReservationDetailModal(cell);
  }
});

function openReservationDetailModal(cell) {
  document.querySelector('input[name="editName"]').value = cell.dataset.name || '';
  document.querySelector('input[name="editRRN"]').value = cell.dataset.rrn || '';
  document.querySelector('input[name="editPhone"]').value = cell.dataset.phone || '';
  document.querySelector('input[name="editDate"]').value = cell.dataset.date || '';
  document.querySelector('select[name="editDepartment"]').value = cell.dataset.department || '';
  document.querySelector('input[name="editDisease"]').value = cell.dataset.disease || '';
  document.querySelector('input[name="editDoctor"]').value = cell.dataset.doctor || '';

  selectedCell = cell;
  document.getElementById('reservationDetailModal').style.display = 'flex';
}


//ìˆ˜ì •ì™„ë£Œì‹œ ì…€ ë‚´ìš© ë°˜ì˜
document.getElementById('editReservationForm').addEventListener('submit', function (e) {
  e.preventDefault();

  const newName = this.editName.value;
  const newRRN = this.editRRN.value;
  const newPhone = this.editPhone.value;
  const newDate = this.editDate.value;
  const newDepartment = this.editDepartment.value;
  const newDisease = this.editDisease.value;
  const newDoctor = this.editDoctor.value;

  if (!selectedCell) return;

	 const updatePayload = {
    name: newName,
    rrn: newRRN,
    phone: newPhone,
    gender: selectedCell.dataset.gender || "",
    date: newDate,
    originalDate: selectedCell.dataset.date, 
    room: newDepartment,
    disease: newDisease,
    doctor: newDoctor
  };

fetch("/acceptance/appointment", {
  method: "PUT",  // âœ… ìˆ˜ì •ì€ PUTìœ¼ë¡œ
  headers: {
    "Content-Type": "application/json"
  },
  body: JSON.stringify(updatePayload)  // âœ… ì˜¬ë°”ë¥¸ ë³€ìˆ˜ëª…
})
.then(response => {
  return response.text().then(msg => {
    if (!response.ok) {
      throw new Error(msg);
    }
    return msg;
  });
})
.then(result => {
  alert(result);  // ì„±ê³µ ë©”ì‹œì§€ ì¶œë ¥
  // ì´í›„ í™”ë©´ ì…€ ì—…ë°ì´íŠ¸ ë˜ëŠ” closeDetailModal(); ìˆ˜í–‰
})
.catch(err => {
  alert("ì˜ˆì•½ ì‹¤íŒ¨: " + err.message);
});



  // ë‚ ì§œì™€ ì‹œê°„ íŒŒì‹±
  const dateObj = new Date(newDate);
  const hour = String(dateObj.getHours()).padStart(2, '0');
  const minute = String(dateObj.getMinutes()).padStart(2, '0');
  const timeStr = `${hour}:${minute}`;

  const roomIndex = {
    'ì§„ë£Œì‹¤1': 1,
    'ì§„ë£Œì‹¤2': 2,
    'ì§„ë£Œì‹¤3': 3,
    'ì§„ë£Œì‹¤4': 4
  }[newDepartment];

  if (roomIndex === undefined) {
    alert("ì§„ë£Œì‹¤ì„ ì •í™•íˆ ì„ íƒí•´ì£¼ì„¸ìš”.");
    return;
  }

  const rows = document.querySelectorAll('.schedule-row');
  let newCell = null;
  let foundRow = false;

  for (const row of rows) {
    const timeCol = row.querySelector('.time-col');
    if (timeCol && timeCol.textContent.trim() === timeStr) {
      const cells = row.querySelectorAll('.cell');
      newCell = cells[roomIndex - 1];
      foundRow = true;
      break;
    }
  }

  if (!foundRow || !newCell) {
    alert("ì…ë ¥í•œ ì‹œê°„ì— í•´ë‹¹í•˜ëŠ” ì…€ì´ ì—†ìŠµë‹ˆë‹¤.");
    return;
  }

  // ì¤‘ë³µ ì²´í¬: ìƒˆ ì…€ì— ì˜ˆì•½ì´ ìˆê³ , ê·¸ê²Œ ìê¸° ì…€ì´ ì•„ë‹Œ ê²½ìš°
  if (newCell !== selectedCell && newCell.innerHTML.trim() !== '') {
    alert("í•´ë‹¹ ì‹œê°„ëŒ€ì— ì´ë¯¸ ì˜ˆì•½ì´ ì¡´ì¬í•©ë‹ˆë‹¤.");
    return;
  }

  // âœ… ê¸°ì¡´ ì…€ ì´ˆê¸°í™”
  selectedCell.classList.remove('green');
  selectedCell.innerHTML = '';
  selectedCell.removeAttribute('data-name');
  selectedCell.removeAttribute('data-rrn');
  selectedCell.removeAttribute('data-phone');
  selectedCell.removeAttribute('data-date');
  selectedCell.removeAttribute('data-department');
  selectedCell.removeAttribute('data-disease');
  selectedCell.removeAttribute('data-doctor');

  // âœ… ìƒˆ ì…€ì— ì˜ˆì•½ ì •ë³´ ë“±ë¡
  newCell.classList.add('green');
  newCell.innerHTML = `[${newName}]<br>${newRRN}`;
  newCell.dataset.name = newName;
  newCell.dataset.rrn = newRRN;
  newCell.dataset.phone = newPhone;
  newCell.dataset.date = newDate;
  newCell.dataset.department = newDepartment;
  newCell.dataset.disease = newDisease;
  newCell.dataset.doctor = newDoctor;

  // âœ… ì…€ í´ë¦­ ì‹œ ë‹¤ì‹œ ìˆ˜ì •í•  ìˆ˜ ìˆê²Œ ì´ë²¤íŠ¸ ë“±ë¡
  newCell.addEventListener('click', function () {
    document.querySelector('input[name="editName"]').value = this.dataset.name || '';
    document.querySelector('input[name="editRRN"]').value = this.dataset.rrn || '';
    document.querySelector('input[name="editPhone"]').value = this.dataset.phone || '';
    document.querySelector('input[name="editDate"]').value = this.dataset.date || '';
    document.querySelector('select[name="editDepartment"]').value = this.dataset.department || '';
    document.querySelector('input[name="editDisease"]').value = this.dataset.disease || '';
    document.querySelector('input[name="editDoctor"]').value = this.dataset.doctor || '';

    selectedCell = this;
    document.getElementById('reservationDetailModal').style.display = 'flex';
  });

  // âœ… ìˆ˜ì • ì™„ë£Œ ì‹œ ëª¨ë‹¬ ë‹«ê¸°
  closeDetailModal();
});

//ëª¨ë‹¬ ë‹«ê¸°
function closeDetailModal() {
  document.getElementById('reservationDetailModal').style.display = 'none';
}
function cancelReservation() {
  if (!selectedCell) return;

  if (confirm("ì •ë§ë¡œ ì´ ì˜ˆì•½ì„ ì·¨ì†Œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?")) {
    const date = selectedCell.dataset.date;
    const rrn = selectedCell.dataset.rrn;

    fetch("/acceptance/appointment", {
      method: "DELETE",
      headers: {
        "Content-Type": "application/json"
      },
      body: JSON.stringify({
        date: date,
        rrn: rrn
      })
    })
    .then(response => {
      return response.text().then(msg => {
        if (!response.ok) throw new Error(msg);
        return msg;
      });
    })
    .then(result => {
      alert(result);  // ì˜ˆ: "ì˜ˆì•½ì´ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤."

      // âœ… í™”ë©´ì—ì„œë„ ì…€ ì´ˆê¸°í™”
      selectedCell.classList.remove('green');
      selectedCell.innerHTML = '';
      selectedCell.removeAttribute('data-name');
      selectedCell.removeAttribute('data-rrn');
      selectedCell.removeAttribute('data-phone');
      selectedCell.removeAttribute('data-date');
      selectedCell.removeAttribute('data-department');
      selectedCell.removeAttribute('data-disease');
      selectedCell.removeAttribute('data-doctor');

      closeDetailModal();
      selectedCell = null;
    })
    .catch(err => {
      alert("ì˜ˆì•½ ì‚­ì œ ì‹¤íŒ¨: " + err.message);
    });
  }
}


function showTab(view) {
  const tabs = document.querySelectorAll('.tab');
  const views = document.querySelectorAll('.schedule-view');
  const dateWrapper = document.querySelector('.top-center-date');
  const weekWrapper = document.querySelector('.top-center-week');
  const registerBtn = document.querySelector('.register-btn-fixed'); // âœ… ì¶”ê°€

  tabs.forEach(tab => tab.classList.remove('active'));
  views.forEach(v => v.classList.remove('active'));

  if (view === 'day') {
    tabs[0].classList.add('active');
    document.getElementById('dayView').classList.add('active');
    dateWrapper.style.display = 'flex';
    weekWrapper.style.display = 'none';
    registerBtn.style.display = 'inline-block';
  } else if (view === 'week') {
    tabs[1].classList.add('active');
    document.getElementById('weekView').classList.add('active');
    dateWrapper.style.display = 'none';
    weekWrapper.style.display = 'flex';
    updateWeekDisplay();
    registerBtn.style.display = 'none'; 
  }
}
document.addEventListener('DOMContentLoaded', function () {
  const today = new Date();
  const formatted = today.toISOString().split('T')[0]; // YYYY-MM-DD
  document.getElementById('currentDate').textContent = `ğŸ“… ${formatted}`;
});

//ë‚ ì§œ ì´ë™í•¨ìˆ˜
let currentDateObj = new Date(); // ì „ì—­ ë³€ìˆ˜ë¡œ í˜„ì¬ ë‚ ì§œ ì €ì¥

function updateDateDisplay() {
  const formatted = currentDateObj.toISOString().split('T')[0];
  document.getElementById('currentDate').textContent = formatted;  // ì´ëª¨ì§€ ì œê±°
}

function changeDate(days) {
	  // 1) currentDateObj( Date )ë¥¼ days(ì •ìˆ˜)ë§Œí¼ ì´ë™
	  currentDateObj.setDate(currentDateObj.getDate() + days);

	  // 2) í™”ë©´ ìƒë‹¨ì— ë‚ ì§œ í…ìŠ¤íŠ¸ë¥¼ ê°±ì‹ 
	  updateDateDisplay();

	  // 3) í˜„ì¬ Viewê°€ Week ëª¨ë“œì¸ì§€ ì²´í¬
	  const isWeekActive = document.getElementById('weekView').classList.contains('active');
	  if (isWeekActive) {
	    // Week ë·°ë¼ë©´ ì£¼ê°„ ë²”ìœ„ë§Œ ë‹¤ì‹œ ê³„ì‚°
	    updateWeekDisplay();
	  } else {
	    // Day ë·°ë¼ë©´, 'YYYY-MM-DD' ë¬¸ìì—´ ë§Œë“¤ì–´ì„œ ì„œë²„ ë°ì´í„° ë‹¤ì‹œ ë¶ˆëŸ¬ì˜¤ê¸°
	    const yyyy = currentDateObj.getFullYear();
	    const mm   = String(currentDateObj.getMonth() + 1).padStart(2, '0');
	    const dd   = String(currentDateObj.getDate()).padStart(2, '0');
	    const dateString = `${yyyy}-${mm}-${dd}`;

	    // í•µì‹¬: ë°”ë€ ë‚ ì§œë¡œ ì„œë²„ì—ì„œ ì˜ˆì•½ ë°ì´í„°ë¥¼ ë‹¤ì‹œ ë¡œë“œ
	    loadAppointmentsByDate(dateString);
	  }
	}

// ì´ˆê¸° ë‚ ì§œ í‘œì‹œ
document.addEventListener('DOMContentLoaded', function () {
  // 1) í™”ë©´ ìƒë‹¨ì— ì˜¤ëŠ˜ ë‚ ì§œ(ë˜ëŠ” currentDateObjì— ë‹´ê¸´ ë‚ ì§œ) í…ìŠ¤íŠ¸ í‘œì‹œ
  updateDateDisplay();
  // 2) Week ëª¨ë“œ ì´ˆê¸°í™” (ê¸°ë³¸ì€ Day ëª¨ë“œë¼ë©´ êµ³ì´ ì•ˆ ë¶ˆëŸ¬ë„ ë©ë‹ˆë‹¤)
  updateWeekDisplay();

  // 3) Day ë·°(ê¸°ë³¸)ì—ì„œ ì˜¤ëŠ˜ ë‚ ì§œ ë°ì´í„°ë¥¼ ì„œë²„ì—ì„œ í•œë²ˆ ë¶ˆëŸ¬ì˜¤ê¸°
  const yyyy = currentDateObj.getFullYear();
  const mm   = String(currentDateObj.getMonth() + 1).padStart(2, '0');
  const dd   = String(currentDateObj.getDate()).padStart(2, '0');
  const todayString = `${yyyy}-${mm}-${dd}`;

  loadAppointmentsByDate(todayString);
});

document.querySelector('.date-icon').addEventListener('click', function () {
  document.getElementById('calendarDateInput').value = currentDateObj.toISOString().split('T')[0];
  document.getElementById('calendarModal').style.display = 'flex';
});

// ëª¨ë‹¬ ë‹«ê¸°
function closeCalendarModal() {
  document.getElementById('calendarModal').style.display = 'none';
}

// ë‚ ì§œ ì„ íƒ í›„ ì ìš©
function applyCalendarDate() {
  const selectedDate = document.getElementById('calendarDateInput').value;
  if (selectedDate) {
    // 1) currentDateObj ì—…ë°ì´íŠ¸
    currentDateObj = new Date(selectedDate);

    // 2) í™”ë©´ ìƒë‹¨ í…ìŠ¤íŠ¸ ê°±ì‹ 
    updateDateDisplay();

    // 3) Day ë·°ì¼ ë•ŒëŠ” ë°”ë¡œ loadAppointmentsByDate í˜¸ì¶œ
    const yyyy = currentDateObj.getFullYear();
    const mm   = String(currentDateObj.getMonth() + 1).padStart(2, '0');
    const dd   = String(currentDateObj.getDate()).padStart(2, '0');
    const dateString = `${yyyy}-${mm}-${dd}`;

    // ë³€ê²½ëœ ë‚ ì§œì˜ ì˜ˆì•½ì„ ì„œë²„ì—ì„œ ë‹¤ì‹œ ë¶ˆëŸ¬ì˜¤ê¸°
    loadAppointmentsByDate(dateString);
  }
  closeCalendarModal();
}

// weekì—ì„œ ë‹¬ë ¥ì•„ì´ì½˜
document.querySelectorAll('.date-icon').forEach(icon => {
  icon.addEventListener('click', function () {
    const isWeek = document.getElementById('weekView').classList.contains('active');
    if (isWeek) {
      openMonthPickerModal();  // Week ì „ìš© ë‹¬ë ¥
    } else {
      document.getElementById('calendarDateInput').value = currentDateObj.toISOString().split('T')[0];
      document.getElementById('calendarModal').style.display = 'flex';
    }
  });
});
document.addEventListener('DOMContentLoaded', function () {
  const selectMonth = document.getElementById('monthSelect');
  if (selectMonth && selectMonth.children.length === 0) {
    for (let m = 1; m <= 12; m++) {
      const opt = document.createElement('option');
      opt.value = m;
      opt.textContent = `${m}ì›”`;
      selectMonth.appendChild(opt);
    }
  }
});
function openMonthPickerModal() {
  const now = currentDateObj;
  document.getElementById('yearSelect').value = now.getFullYear();
  document.getElementById('monthSelect').value = now.getMonth() + 1;
  document.getElementById('monthPickerModal').style.display = 'flex';
}

function closeMonthPickerModal() {
  document.getElementById('monthPickerModal').style.display = 'none';
}

function applyMonthSelection() {
  const year = parseInt(document.getElementById('yearSelect').value);
  const month = parseInt(document.getElementById('monthSelect').value) - 1;

  if (isNaN(year) || isNaN(month)) {
    alert("ë…„/ì›”ì„ ì˜¬ë°”ë¥´ê²Œ ì„ íƒí•˜ì„¸ìš”.");
    return;
  }

  // ì„ íƒí•œ ì›”ì˜ 1ì¼ ê¸°ì¤€
  const firstOfMonth = new Date(year, month, 1);
  const dayOfWeek = firstOfMonth.getDay(); // 0(ì¼)~6(í† )

  // í•´ë‹¹ 1ì¼ì´ í¬í•¨ëœ ì£¼ì˜ ì›”ìš”ì¼ë¡œ ì´ë™ (ë‹¬ë ¥ ê¸°ì¤€)
  const monday = new Date(firstOfMonth);
  monday.setDate(firstOfMonth.getDate() - ((dayOfWeek + 6) % 7));

  currentDateObj = new Date(monday);
  updateWeekDisplay();
  closeMonthPickerModal();
}
function updateWeekDisplay() {
  const current = new Date(currentDateObj);
  const dayOfWeek = current.getDay(); // 0(ì¼) ~ 6(í† )
  const diffToMonday = (dayOfWeek + 6) % 7; // ì›”(1) -> 0, ì¼(0) -> 6
  const monday = new Date(current);
  monday.setDate(current.getDate() - diffToMonday);

  // âœ… í˜„ì¬ ê¸°ì¤€ë„ ì›”ìš”ì¼ë¡œ ë§ì¶°ì£¼ë©´ ì´í›„ ì´ë™ ì‹œ ì•ˆì •ì 
  currentDateObj = new Date(monday);

  const sunday = new Date(monday);
  sunday.setDate(monday.getDate() + 6);

  const formatDate = (date) => date.toISOString().split('T')[0];
  const start = formatDate(monday);
  const end = formatDate(sunday);

  document.getElementById('weekDateRange').textContent = `${start} ~ ${end}`;

  const dates = [];
  for (let i = 0; i < 5; i++) {
    const d = new Date(monday);
    d.setDate(monday.getDate() + i);
    dates.push(d.toISOString().split('T')[0]);
  }

  loadAppointmentsForWeek(dates);
}


document.addEventListener("DOMContentLoaded", () => {
  const select = document.getElementById("doctorSelect");

  fetch("/api/doctors")
    .then(res => {
      if (!res.ok) throw new Error("ì„œë²„ ì˜¤ë¥˜: " + res.status);
      return res.json();
    })
    .then(doctors => {
      if (!Array.isArray(doctors)) throw new Error("ë°ì´í„° í˜•ì‹ ì˜¤ë¥˜");

      doctors.forEach(doc => {
        const option = document.createElement("option");
        option.value = doc.usersId;
        option.textContent = doc.usersName;
        select.appendChild(option);
      });
    })
    .catch(err => {
      console.error("ì˜ì‚¬ ëª©ë¡ ë¡œë”© ì‹¤íŒ¨", err);
      alert("ì˜ì‚¬ ëª©ë¡ì„ ë¶ˆëŸ¬ì˜¤ëŠ” ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.");
    });
});

// ìë™ì™„ì„± ëª©ë¡ ë¶ˆëŸ¬ì˜¤ê¸°
document.getElementById("patientNameInput").addEventListener("input", function () {
  const name = this.value.trim();
  if (name === "") return;

  fetch(`/acceptance/searchPatientsByName?name=${encodeURIComponent(name)}`)
    .then(res => res.json())
    .then(list => {
      const datalist = document.getElementById("patientList");
      datalist.innerHTML = "";
      list.forEach(p => {
        const opt = document.createElement("option");
        opt.value = `${p.name} (${p.rrn})`;  // ë³´ì—¬ì§€ëŠ” í˜•ì‹
        opt.dataset.name = p.name;
        opt.dataset.rrn = p.rrn;
        opt.dataset.gender = p.gender;
        opt.dataset.phone = p.phone;
        datalist.appendChild(opt);
      });
    });
});

// 2. change ì‹œ â†’ ì‹¤ì œ optionê³¼ ë¹„êµ í›„ ìë™ì…ë ¥ + ì´ë¦„ í•„ë“œ ì •ë¦¬
document.getElementById("patientNameInput").addEventListener("change", function () {
  const inputVal = this.value.trim();
  const rrnMatch = inputVal.match(/\(([^)]+)\)/); // ê´„í˜¸ ì•ˆ ì£¼ë¯¼ë²ˆí˜¸ ì¶”ì¶œ
  const rrnOnly = rrnMatch ? rrnMatch[1] : null;

  const options = document.querySelectorAll('#patientList option');
  for (const opt of options) {
    if (opt.dataset.rrn === rrnOnly) {
      // âœ… ì´ë¦„ë§Œ ë‚¨ê¸°ê¸°
      this.value = opt.dataset.name;

      // âœ… ìë™ì…ë ¥
      document.querySelector('select[name="gender"]').value = opt.dataset.gender || "";
      document.querySelector('input[name="rrn"]').value = opt.dataset.rrn || "";
      document.querySelector('input[name="phone"]').value = opt.dataset.phone || "";
      break;
    }
  }
});

function loadAppointmentsByDate(dateString) {
	  // 1) í™”ë©´ì— ì´ë¯¸ ê·¸ë ¤ì§„ ëª¨ë“  "green ì…€"ì„ ì§€ìš°ê³  ì´ˆê¸°í™”
	  document.querySelectorAll('.cell').forEach(cell => {
	    cell.classList.remove('green');
	    cell.innerHTML = '';
	    cell.removeAttribute('data-name');
	    cell.removeAttribute('data-rrn');
	    cell.removeAttribute('data-phone');
	    cell.removeAttribute('data-date');
	    cell.removeAttribute('data-department');
	    cell.removeAttribute('data-disease');
	    cell.removeAttribute('data-doctor');
	  });

	  // 2) ì„œë²„ì—ì„œ í•´ë‹¹ ë‚ ì§œ(dateString)ì˜ ì˜ˆì•½ ë¦¬ìŠ¤íŠ¸ë¥¼ ê°€ì ¸ì˜´
	  fetch(`/acceptance/appointments?date=${dateString}`)
	    .then(res => {
	      if (!res.ok) {
	        throw new Error("ì„œë²„ ì‘ë‹µ ì˜¤ë¥˜: " + res.status);
	      }
	      return res.json();
	    })
	    .then(list => {
	      // JSON ë¦¬ìŠ¤íŠ¸ë¥¼ ìˆœíšŒí•˜ë©´ì„œ, ê° ì˜ˆì•½ì„ schedule-rowì— ë¿Œë¦¼
	      list.forEach(appt => {
	        const date = new Date(appt.date); // appt.date: "2025-06-05T13:00:00" ë“±
	        const hour = String(date.getHours()).padStart(2, '0');
	        const minute = String(date.getMinutes()).padStart(2, '0');
	        const timeStr = `${hour}:${minute}`;

	        // ëª‡ ë²ˆì§¸ column(ì§„ë£Œì‹¤)ì¸ì§€ ê³„ì‚°
	        const roomIndex = {
	          'ì§„ë£Œì‹¤1': 1,
	          'ì§„ë£Œì‹¤2': 2,
	          'ì§„ë£Œì‹¤3': 3,
	          'ì§„ë£Œì‹¤4': 4
	        }[appt.room];

	        if (!roomIndex) return;

	        // í™”ë©´ì— ìˆëŠ” ëª¨ë“  <div class="schedule-row"> ìˆœíšŒ
	        const rows = document.querySelectorAll('.schedule-row');
	        for (const row of rows) {
	          const timeCol = row.querySelector('.time-col');
	          if (timeCol && timeCol.textContent.trim() === timeStr) {
	            const cells = row.querySelectorAll('.cell');
	            const cell = cells[roomIndex - 1];

	            // ì˜ˆì•½ì´ ìˆëŠ” ì…€ í‘œì‹œ: ë…¹ìƒ‰ìœ¼ë¡œ ë°”ê¾¸ê³ , ë°ì´í„° ì†ì„±ì— ì˜ˆì•½ì •ë³´ ì €ì¥
	            cell.classList.add('green');
	            cell.innerHTML = `[${appt.name}]<br>${appt.rrn}`; 
	            cell.dataset.name       = appt.name;
	            cell.dataset.rrn        = appt.rrn;
	            cell.dataset.phone      = appt.phone;
	            cell.dataset.date       = appt.date;       // ì‹¤ì œ ë‚ ì§œÂ·ì‹œê°„
	            cell.dataset.department = appt.room;       // â€œì§„ë£Œì‹¤1â€ ë“±
	            cell.dataset.disease    = appt.disease;
	            cell.dataset.doctor     = appt.doctor;
	            break; 
	          }
	        }
	      });
	    })
	    .catch(err => {
	      console.error("ì˜ˆì•½ ë¶ˆëŸ¬ì˜¤ê¸° ì‹¤íŒ¨:", err);
	      alert("ì˜ˆì•½ ëª©ë¡ì„ ê°€ì ¸ì˜¤ëŠ” ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.");
	    });
	}
	
function loadAppointmentsForWeek(dateList) {
  document.querySelectorAll('#weekView .cell').forEach(cell => {
    cell.classList.remove('green');
    cell.innerHTML = '';
    cell.removeAttribute('data-name');
    cell.removeAttribute('data-rrn');
    cell.removeAttribute('data-phone');
    cell.removeAttribute('data-date');
    cell.removeAttribute('data-department');
    cell.removeAttribute('data-disease');
    cell.removeAttribute('data-doctor');
  });

  dateList.forEach((dateStr) => {
    fetch(`/acceptance/appointments?date=${dateStr}`)
      .then(res => res.json())
      .then(list => {
        list.forEach(appt => {
          const date = new Date(appt.date);
          const day = date.getDay(); // 0(ì¼) ~ 6(í† )
          const dayIndex = day - 1;  // ì›”(1) â†’ 0 ~ ê¸ˆ(5) â†’ 4

          if (dayIndex < 0 || dayIndex > 4) return; // ì£¼ë§ ì œì™¸

          const hour = String(date.getHours()).padStart(2, '0');
          const minute = String(date.getMinutes()).padStart(2, '0');
          const timeStr = `${hour}:${minute}`;

          const roomIndex = {
            'ì§„ë£Œì‹¤1': 0,
            'ì§„ë£Œì‹¤2': 1,
            'ì§„ë£Œì‹¤3': 2,
            'ì§„ë£Œì‹¤4': 3
          }[appt.room];

          if (roomIndex === undefined) return;

          const rows = document.querySelectorAll('#weekView .schedule-row');
          for (const row of rows) {
            const timeCol = row.querySelector('.time-col');
            if (timeCol && timeCol.textContent.trim() === timeStr) {
              const cells = row.querySelectorAll('.cell');
              const targetCell = cells[dayIndex];
              targetCell.classList.add('green');
              targetCell.innerHTML = `[${appt.name}]<br>${appt.rrn}`;
              targetCell.dataset.name       = appt.name;
              targetCell.dataset.rrn        = appt.rrn;
              targetCell.dataset.phone      = appt.phone;
              targetCell.dataset.date       = appt.date;
              targetCell.dataset.department = appt.room;
              targetCell.dataset.disease    = appt.disease;
              targetCell.dataset.doctor     = appt.doctor;
              break;
            }
          }
        });
      })
      .catch(err => {
        console.error("ì£¼ê°„ ì˜ˆì•½ ë¶ˆëŸ¬ì˜¤ê¸° ì‹¤íŒ¨:", err);
      });
  });
}

document.querySelector('#weekView .schedule-table').addEventListener('click', function (e) {
  const cell = e.target;

  // ì…€ ì™¸ ì˜ì—­ í´ë¦­ ì‹œ ë¬´ì‹œ
  if (!cell.classList.contains('cell')) return;

  // ì˜ˆì•½ì´ ìˆëŠ” ì…€(green)ë§Œ í´ë¦­ ê°€ëŠ¥í•˜ë„ë¡ ì œí•œ
  if (cell.classList.contains('green')) {
    openReservationDetailModal(cell);
  }

  // ì˜ˆì•½ì´ ì—†ëŠ” ì…€ì€ ì•„ë¬´ ë™ì‘í•˜ì§€ ì•ŠìŒ
});
</script>


</body>
</html>
